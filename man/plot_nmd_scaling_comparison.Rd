% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rvdriver_functions.R
\name{plot_nmd_scaling_comparison}
\alias{plot_nmd_scaling_comparison}
\title{Plot NMD scaling and return the scaled RNA VAFs for nonsense mutations}
\usage{
plot_nmd_scaling_comparison(mutation_table, cancer_type, outdir)
}
\arguments{
\item{mutation_table}{A data frame containing mutation data. Expected columns include
\code{gene}, \code{func}, \code{RNA_VAF}, \code{RNA_depth}, \code{pos}, and optionally
\code{chrom} and \code{is_cgc}.}

\item{cancer_type}{Character. Cancer type label used in plotting and saving}

\item{outdir}{Character. Directory in which to save the output plot.}
}
\value{
A list with two elements:
\itemize{
\item \code{plot}: The ggplot object for the NMD scaling comparison.
\item \code{mutation_table}: The updated mutation table with the added
\code{RNA_VAF_scaled} column.
}
}
\description{
This function performs NMD scaling on nonsense mutations by computing a scaling
factor as \code{mean(RNA_VAF[Missense]) / mean(RNA_VAF[Nonsense])} (forced to be at
least 1) and applies it to the nonsense mutations (with values capped at 1).
It creates a boxplot that compares:
\itemize{
\item \strong{Nonsense (Pre-scaling)}: Original RNA VAF for nonsense mutations.
\item \strong{Nonsense (Post-scaling)}: Scaled RNA VAF for nonsense mutations.
\item \strong{Missense}: RNA VAF for missense mutations.
}
}
